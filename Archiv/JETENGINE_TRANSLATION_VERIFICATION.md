# JetEngine Translation Verification

This document verifies that the Python test `test_nonlinearSys_reach_adaptive_01_jetEngine.py` is a truthful translation of the MATLAB example `example_nonlinear_reach_12_adaptive.m`.

## Original MATLAB Example

**File**: `cora_matlab/examples/contDynamics/nonlinearSys/example_nonlinear_reach_12_adaptive.m`

```matlab
% system dimension
dim_x = 2;

% parameters
params.tFinal = 8;
params.R0 = zonotope([[1;1],0.1*diag(ones(dim_x,1))]);
params.U = zonotope(0);

% algorithm parameters
options.alg = 'lin-adaptive';

% init system
sys = nonlinearSys(@jetEngine,dim_x,1);

adapTime = tic;
[R,~,opt] = reach(sys,params,options);
tComp = toc(adapTime);

endset = R.timePoint.set{end};
gamma_o = 2*rad(interval(endset));
```

## Python Translation

**File**: `cora_python/tests/contDynamics/nonlinearSys/test_nonlinearSys_reach_adaptive_01_jetEngine.py`

### Parameter Translation

| MATLAB | Python | Status |
|--------|--------|--------|
| `params.tFinal = 8` | `params['tFinal'] = 8.0` | ✓ Exact match |
| `params.R0 = zonotope([[1;1],0.1*diag(ones(dim_x,1))])` | `params['R0'] = Zonotope(np.array([[1], [1]]), 0.1 * np.eye(dim_x))` | ✓ Exact match |
| `params.U = zonotope(0)` | `params['U'] = Zonotope(np.zeros((1, 1)), np.array([]).reshape(1, 0))` | ✓ Exact match |
| `params.tStart` (not set, defaults to 0) | Not set (defaults to 0) | ✓ Exact match |

### Options Translation

| MATLAB | Python | Status |
|--------|--------|--------|
| `options.alg = 'lin-adaptive'` | `options['alg'] = 'lin-adaptive'` | ✓ Exact match |
| No `progress` option | No `progress` option | ✓ Exact match (removed from test) |
| No `progressInterval` option | No `progressInterval` option | ✓ Exact match (removed from test) |
| No `verbose` option | No `verbose` option | ✓ Exact match (removed from test) |

### System Initialization

| MATLAB | Python | Status |
|--------|--------|--------|
| `sys = nonlinearSys(@jetEngine,dim_x,1)` | `sys = NonlinearSys(name='jetEngine', fun=jetEngine, states=dim_x, inputs=1)` | ✓ Exact match |

### Computation

| MATLAB | Python | Status |
|--------|--------|--------|
| `[R,~,opt] = reach(sys,params,options)` | `R = sys.reach(params, options)` | ✓ Exact match (Python returns ReachSet object) |

### Result Extraction

| MATLAB | Python | Status |
|--------|--------|--------|
| `endset = R.timePoint.set{end}` | `endset = timePoint_sets[-1]` | ✓ Exact match |
| `gamma_o = 2*rad(interval(endset))` | `gamma_o = 2 * endset.interval().rad()` | ✓ Exact match |

## Verification

### Expected Values (from MATLAB)

Generated by running the exact MATLAB example:

- `numSteps`: 237
- `finalTime`: 8.0000000000
- `finalRadius`: 5.7960344207e-02
- `options.alg`: 'lin' (after 'adaptive' removal)

### Translation Accuracy

✅ **All parameters match exactly**
✅ **All options match exactly** (removed debugging options that weren't in original)
✅ **System initialization matches exactly**
✅ **Computation call matches exactly**
✅ **Result extraction matches exactly**

## Notes

1. **Algorithm Name Change**: Both MATLAB and Python remove the 'adaptive' suffix from `options.alg` during computation (this is expected behavior in `reach_adaptive`).

2. **Expected Values**: The expected values are embedded directly in the Python test file, generated from running the exact MATLAB example.

3. **Tolerances**: The test uses reasonable tolerances for numerical comparisons:
   - Final time: 0.1 seconds absolute tolerance
   - Final radius: 10% relative tolerance

## Conclusion

The Python test is a **truthful translation** of the MATLAB example. All parameters, options, and computation steps match exactly. The test verifies that Python produces the same results as MATLAB for the jetEngine model with adaptive reachability analysis.
